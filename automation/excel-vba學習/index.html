<!DOCTYPE html>
<html lang="zh-tw"><head>
  <meta charset="utf-8">
  <title>Excel VBA 學習筆記：從入門到網路爬蟲 | Land-Knowledge</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
  <meta name="description" content="本筆記整理了 Excel VBA 的學習資源、環境設定、基礎語法、物件操作與網路爬蟲實作，適合作為入門到進階的學習參考。">
  <meta name="author" content="定康">
  <meta name="theme-color" content="#fff">
  
  <!-- canonical link -->
  <link rel="canonical" href="https://tomisagoodguy.github.io/automation/excel-vba%E5%AD%B8%E7%BF%92/">

  <!-- theme meta -->
  <meta name="theme-name" content="liva-hugo" />
  <meta name="generator" content="Hugo 0.127.0">

  <!-- Open Graph & Twitter Card -->
  <meta property="og:title" content="Excel VBA 學習筆記：從入門到網路爬蟲 | Land-Knowledge">
  <meta property="og:description" content="本筆記整理了 Excel VBA 的學習資源、環境設定、基礎語法、物件操作與網路爬蟲實作，適合作為入門到進階的學習參考。">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://tomisagoodguy.github.io/automation/excel-vba%E5%AD%B8%E7%BF%92/">
  
  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Excel VBA 學習筆記：從入門到網路爬蟲 | Land-Knowledge">
  <meta name="twitter:description" content="本筆記整理了 Excel VBA 的學習資源、環境設定、基礎語法、物件操作與網路爬蟲實作，適合作為入門到進階的學習參考。">
  
  

  <!-- Resource Hints -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://cdnjs.cloudflare.com">
  

  <!-- plugins -->
  
  <link rel="stylesheet" href="https://tomisagoodguy.github.io/plugins/bootstrap/bootstrap.min.css" >
  
  
  <link rel="stylesheet" href="https://tomisagoodguy.github.io/plugins/slick/slick.css" >
  
  
  <link rel="stylesheet" href="https://tomisagoodguy.github.io/plugins/themify-icons/themify-icons.css" >
  
  
  <link rel="stylesheet" href="https://tomisagoodguy.github.io/plugins/venobox/venobox.css" >
  
  
  <link rel="stylesheet" href="https://tomisagoodguy.github.io/css/custom.css" >
  
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://tomisagoodguy.github.io/scss/style.min.css" media="screen">

  <!-- Custom Stylesheet -->
  <link rel="stylesheet" href="https://tomisagoodguy.github.io/css/custom.css" media="screen">

  <!-- Font Awesome CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer" media="print" onload="this.media='all'">
  <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"></noscript>

  <!--Favicon-->
  <link rel="apple-touch-icon" sizes="180x180" href="https://tomisagoodguy.github.io/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://tomisagoodguy.github.io/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://tomisagoodguy.github.io/images/favicon-16x16.png">
  <link rel="shortcut icon" href="https://tomisagoodguy.github.io/images/favicon.ico" type="image/x-icon">
  <link rel="manifest" href="https://tomisagoodguy.github.io/images/site.webmanifest">

  <!-- Structured Data -->
  
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Article",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https:\/\/tomisagoodguy.github.io\/automation\/excel-vba%E5%AD%B8%E7%BF%92\/"
      },
      "headline": "Excel VBA 學習筆記：從入門到網路爬蟲",
      "description": "本筆記整理了 Excel VBA 的學習資源、環境設定、基礎語法、物件操作與網路爬蟲實作，適合作為入門到進階的學習參考。",
      
      "datePublished": "2025-11-08T00:00:00\u002b08:00",
      "dateModified": "2025-12-27T18:57:08\u002b08:00",
      "author": {
        "@type": "Person",
        "name": "定康"
      },
      "publisher": {
        "@type": "Organization",
        "name": "Land-Knowledge",
        "logo": {
          "@type": "ImageObject",
          "url": "https:\/\/tomisagoodguy.github.io\/images\/law.png"
        }
      }
    }
  </script>
  

  <!-- Google Analytics -->
  
  <script>
    
    window['ga-disable-G-ZZ3XT9EZKH'] = true;
    
    
    if (localStorage.getItem('cookie-consent') === 'true') {
      window['ga-disable-G-ZZ3XT9EZKH'] = false;
    }
  </script>
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZZ3XT9EZKH"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-ZZ3XT9EZKH', {
      'anonymize_ip': true,
      'cookie_flags': 'SameSite=None;Secure'
    });
  </script>
  
</head>
<body>
<!-- preloader start -->
<div class="preloader" id="preloader" aria-hidden="true" aria-label="頁面加載中">
  <div class="preloader-content">
    
    <div class="preloader-spinner"></div>
    
    <p class="preloader-text">加載中...</p>
  </div>
</div>

<style>
  .preloader {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ffffff;
    z-index: 9999;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 1;
    visibility: visible;
    transition: opacity 0.5s ease, visibility 0.5s ease;
  }
  
  .preloader.loaded {
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
  }
  
  .preloader-content {
    text-align: center;
  }
  
  .preloader img {
    max-width: 80px;
    width: auto;
    height: auto;
    animation: pulse 1.5s ease infinite;
  }
  
  .preloader-text {
    margin-top: 15px;
    font-size: 14px;
    color: #333333;
    opacity: 0.8;
  }
  
  .preloader-spinner {
    width: 40px;
    height: 40px;
    margin: 0 auto;
    border: 3px solid #f3f3f3;
    border-top: 3px solid #3498db;
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }
  
  @keyframes pulse {
    0% {
      transform: scale(1);
    }
    50% {
      transform: scale(1.05);
    }
    100% {
      transform: scale(1);
    }
  }
  
  @keyframes spin {
    0% {
      transform: rotate(0deg);
    }
    100% {
      transform: rotate(360deg);
    }
  }
  
   
  body.loading {
    overflow: hidden;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    document.body.classList.add('loading');
    
    
    window.addEventListener('load', function() {
      const preloader = document.getElementById('preloader');
      if (preloader) {
        
        preloader.classList.add('loaded');
        
        
        setTimeout(function() {
          document.body.classList.remove('loading');
        }, 500);
        
        
        setTimeout(function() {
          preloader.parentNode.removeChild(preloader);
        }, 1000);
      }
    });
    
    
    setTimeout(function() {
      const preloader = document.getElementById('preloader');
      if (preloader && !preloader.classList.contains('loaded')) {
        preloader.classList.add('loaded');
        document.body.classList.remove('loading');
      }
    },  8000 );
  });
</script>
<!-- preloader end -->

<!-- navigation -->
<header class="navigation">
  <div class="container">
    
    <nav class="navbar navbar-expand-lg navbar-white bg-transparent border-bottom pl-0">
      <a class="navbar-brand mobile-view" href="https://tomisagoodguy.github.io/">
        
        <img loading="lazy" class="img-fluid" src="https://tomisagoodguy.github.io/images/law.png" alt="Land-Knowledge">
        
      </a>
      <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navigation">
        <i class="ti-menu"></i>
      </button>

      <div class="collapse navbar-collapse text-center" id="navigation">
        <div class="desktop-view">
          <ul class="navbar-nav mr-auto">
            
            <li class="nav-item">
              <a class="nav-link" href="https://www.facebook.com/profile.php?id=100005583693079"><i class="ti-facebook"></i></a>
            </li>
            
            <li class="nav-item">
              <a class="nav-link" href="https://github.com/tomisagoodguy?tab=repositories"><i class="ti-github"></i></a>
            </li>
            
          </ul>
        </div>

        <a class="navbar-brand mx-auto desktop-view" href="https://tomisagoodguy.github.io/">
          
          <img loading="lazy" class="img-fluid" src="https://tomisagoodguy.github.io/images/law.png" alt="Land-Knowledge">
          
        </a>

        <ul class="navbar-nav">
          
          
          <li class="nav-item">
            
            <a class="nav-link" href="https://tomisagoodguy.github.io/">首頁</a>
            
          </li>
          
          
          
          <li class="nav-item">
            
            <a class="nav-link" href="https://tomisagoodguy.github.io/lifestyle/">廚藝與生活</a>
            
          </li>
          
          
          
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="https://tomisagoodguy.github.io/real-estate/" role="button" data-toggle="dropdown"
              aria-haspopup="true" aria-expanded="false">
              代書修煉
            </a>
            <div class="dropdown-menu">
              
              <a class="dropdown-item" href="https://tomisagoodguy.github.io/real-estate/exam-notes/">考試筆記</a>
              
            </div>
          </li>
          
          
          
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="https://tomisagoodguy.github.io/automation/" role="button" data-toggle="dropdown"
              aria-haspopup="true" aria-expanded="false">
              自動化實驗室
            </a>
            <div class="dropdown-menu">
              
              <a class="dropdown-item" href="https://tomisagoodguy.github.io/automation/">所有文章</a>
              
              <a class="dropdown-item" href="https://tomisagoodguy.github.io/tools/property-tax.html">房地稅務試算</a>
              
            </div>
          </li>
          
          
          
          <li class="nav-item">
            
            <a class="nav-link about-me-nav" href="https://tomisagoodguy.github.io/about/">關於</a>
            
          </li>
          
          
          
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="https://tomisagoodguy.github.io/links/" role="button" data-toggle="dropdown"
              aria-haspopup="true" aria-expanded="false">
              相關連結
            </a>
            <div class="dropdown-menu">
              
              <a class="dropdown-item" href="https://tomisagoodguy.github.io/links/#%E5%AF%A6%E7%94%A8%E5%B7%A5%E5%85%B7">實用工具</a>
              
              <a class="dropdown-item" href="https://tomisagoodguy.github.io/links/#%E5%9C%B0%E6%94%BF%E7%9B%B8%E9%97%9C%E7%B6%B2%E7%AB%99">地政相關網站</a>
              
              <a class="dropdown-item" href="https://tomisagoodguy.github.io/links/#%E7%90%86%E8%B2%A1%E7%9B%B8%E9%97%9C%E7%B6%B2%E7%AB%99">理財相關網站</a>
              
              <a class="dropdown-item" href="https://tomisagoodguy.github.io/links/#%E6%B1%82%E8%81%B7%E7%9B%B8%E9%97%9C%E7%B6%B2%E7%AB%99">求職相關網站</a>
              
              <a class="dropdown-item" href="https://tomisagoodguy.github.io/links/#%E5%85%B6%E4%BB%96">其他</a>
              
            </div>
          </li>
          
          
        </ul>

        <div class="theme-switch-wrapper pl-lg-4">
          <label class="theme-switch" for="checkbox">
            <input type="checkbox" id="checkbox" />
            <div class="slider round"></div>
          </label>
        </div>

        
        <!-- search -->
        <div class="search pl-lg-4">
          <button id="searchOpen" class="search-btn"><i class="ti-search"></i></button>
          <div class="search-wrapper">
            <form action="https://tomisagoodguy.github.io//search" class="h-100">
              <input class="search-box px-4" id="search-query" name="s" type="search" placeholder="輸入關鍵字並按 Enter...">
            </form>
            <button id="searchClose" class="search-close"><i class="ti-close text-dark"></i></button>
          </div>
        </div>
        

        
      </div>
    </nav>
  </div>
</header>










<section class="section-sm category-excel-vba">
  <div class="container">
    <div class="row">
      
      <div class="col-lg-3">
        <div class="toc-placeholder"></div>
        <div class="toc-container">
          <div class="toc-title">文章目錄</div>
          <div class="toc-content">
            <nav><nav id="TableOfContents">
  <ul>
    <li><a href="#學習資源">學習資源</a>
      <ul>
        <li><a href="#excel-vba-金融資料抓取--打造股票研究系統">Excel VBA 金融資料抓取 | 打造股票研究系統</a></li>
      </ul>
    </li>
    <li><a href="#vba-環境設置">VBA 環境設置</a>
      <ul>
        <li><a href="#1-開啟開發人員工具">1. 開啟開發人員工具</a></li>
        <li><a href="#2-開啟-vba-編輯器-vbe">2. 開啟 VBA 編輯器 (VBE)</a></li>
        <li><a href="#3-開啟常用視窗">3. 開啟常用視窗</a></li>
        <li><a href="#4-調整編輯器字形與風格">4. 調整編輯器字形與風格</a></li>
      </ul>
    </li>
    <li><a href="#vba-基礎概念">VBA 基礎概念</a>
      <ul>
        <li><a href="#專案與模組">專案與模組</a></li>
        <li><a href="#程序-sub--function">程序 (Sub / Function)</a></li>
        <li><a href="#模組化程式設計-call">模組化程式設計 (Call)</a></li>
        <li><a href="#變數-variables-與資料型別">變數 (Variables) 與資料型別</a></li>
        <li><a href="#註解-comments">註解 (Comments)</a></li>
      </ul>
    </li>
    <li><a href="#操作-excel-物件與互動">操作 Excel 物件與互動</a>
      <ul>
        <li><a href="#核心物件工作表-worksheet-與儲存格-range--cells">核心物件：工作表 (Worksheet) 與儲存格 (Range / Cells)</a></li>
        <li><a href="#互動與除錯及時運算視窗-immediate-window">互動與除錯：及時運算視窗 (Immediate Window)</a></li>
      </ul>
    </li>
    <li><a href="#條件判斷-conditional-logic">條件判斷 (Conditional Logic)</a>
      <ul>
        <li><a href="#if--then--else">If &hellip; Then &hellip; Else</a></li>
      </ul>
    </li>
    <li><a href="#迴圈控制-loops">迴圈控制 (Loops)</a>
      <ul>
        <li><a href="#for-each--next-迴圈">For Each &hellip; Next 迴圈</a></li>
      </ul>
    </li>
    <li><a href="#excel-vba-網路爬蟲">Excel VBA 網路爬蟲</a>
      <ul>
        <li><a href="#1-網路爬蟲核心概念">1. 網路爬蟲核心概念</a></li>
        <li><a href="#2-分析網頁資料來源-chrome-開發人員工具">2. 分析網頁資料來源 (Chrome 開發人員工具)</a></li>
        <li><a href="#3-vba-實作網頁資料抓取">3. VBA 實作網頁資料抓取</a></li>
        <li><a href="#4-解析不同格式的資料">4. 解析不同格式的資料</a>
          <ul>
            <li><a href="#a-html-格式">A. HTML 格式</a></li>
            <li><a href="#b-json-格式">B. JSON 格式</a></li>
            <li><a href="#c-csv-格式逗號分隔值">C. CSV 格式/逗號分隔值</a></li>
            <li><a href="#d-暴力解決法">D. 暴力解決法</a></li>
            <li><a href="#e-字串處理split-函數">E. 字串處理：Split 函數</a></li>
            <li><a href="#f-字串處理replace-函數">F. 字串處理：Replace 函數</a></li>
            <li><a href="#g-進階字串處理chr34-與雙引號的處理">G. 進階字串處理：Chr(34) 與雙引號的處理</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#附錄資源連結">附錄：資源連結</a></li>
    <li><a href="#範例檔案下載">範例檔案下載</a></li>
    <li><a href="#常見問題-faq">常見問題 (FAQ)</a>
      <ul>
        <li><a href="#q1-字串與變數如何連接">Q1: 字串與變數如何連接？</a></li>
        <li><a href="#q2-爬蟲請求方法-get-與-post-有何差異">Q2: 爬蟲請求方法 GET 與 POST 有何差異？</a></li>
        <li><a href="#5-進階技巧http-headers-設定-request-headers">5. 進階技巧：HTTP Headers 設定 (Request Headers)</a></li>
      </ul>
    </li>
    <li><a href="#實用工具連結">實用工具連結</a></li>
    <li><a href="#結語">結語</a></li>
  </ul>
</nav></nav>
          </div>
        </div>
      </div>

      
      <div class="col-lg-9">
        
        <a href="/categories/excel-vba" class="badge badge-primary badge-sm">Excel vba</a>
        
        <h2>Excel VBA 學習筆記：從入門到網路爬蟲</h2>
        <div class="mb-3 post-meta">
          <span>By 定康</span>
          
          <span class="border-bottom border-primary px-2 mx-1"></span>
          <span>08 November 2025</span>
          
          <span class="border-bottom border-primary px-2 mx-1"></span>
          <span>7 min read</span>
        </div>


        <div class="content mb-5 post-content">
          <p><em>此為個人學習筆記，內容主要整理自相關課程與網路資源，僅供學習與參考之用。</em></p>
<p>12/25上到4-2</p>
<h2 id="學習資源">學習資源</h2>
<blockquote>
<h3 id="excel-vba-金融資料抓取--打造股票研究系統">Excel VBA 金融資料抓取 | 打造股票研究系統</h3>
<ul>
<li><strong>課程網站</strong>：<a href="https://hahow.in/courses/5d2f3980fe9fef0021fac548">Hahow 好學校</a></li>
</ul>
</blockquote>
<hr>
<h2 id="vba-環境設置">VBA 環境設置</h2>
<p>在開始撰寫 VBA 程式碼之前，需要先設定好開發環境。</p>
<h3 id="1-開啟開發人員工具">1. 開啟開發人員工具</h3>
<p>若 Excel 功能區沒有顯示 <strong>[開發人員]</strong> 索引籤，請至 <strong>[檔案]</strong> &gt; <strong>[選項]</strong> &gt; <strong>[自訂功能區]</strong>，在右側將 <strong>[開發人員]</strong> 打勾。</p>
<h3 id="2-開啟-vba-編輯器-vbe">2. 開啟 VBA 編輯器 (VBE)</h3>
<ul>
<li><strong>方法一</strong>：點選 <strong>[開發人員]</strong> 索引籤中的 <strong>[Visual Basic]</strong> 按鈕。</li>
<li><strong>方法二</strong>：使用快捷鍵 <code>Alt + F11</code>。</li>
</ul>
<h3 id="3-開啟常用視窗">3. 開啟常用視窗</h3>
<p>在 VBA 編輯器中，從 <strong>[檢視]</strong> 選單開啟以下常用視窗，以便於程式碼的撰寫與除錯：</p>
<ul>
<li><strong>專案總管 (Project Explorer)</strong> <code>(Ctrl+R)</code>：管理專案中的所有物件，如模組、工作表等。</li>
<li><strong>屬性視窗 (Properties Window)</strong> <code>(F4)</code>：檢視與編輯所選物件的屬性。</li>
<li><strong>及時運算視窗 (Immediate Window)</strong> <code>(Ctrl+G)</code>：用於即時測試程式碼或顯示變數值。</li>
<li><strong>區域變數視窗 (Locals Window)</strong>：顯示目前程序中所有區域變數的值，在除錯時非常有用。</li>
</ul>
<h3 id="4-調整編輯器字形與風格">4. 調整編輯器字形與風格</h3>
<p>為了提升程式碼的可讀性，建議調整編輯器的設定：</p>
<ol>
<li>前往 <strong>[工具 (Tools)]</strong> &gt; <strong>[選項 (Options)]</strong>。</li>
<li>選擇 <strong>[撰寫風格 (Editor Format)]</strong> 頁籤。</li>
<li>將 <strong>字形 (Font)</strong> 設定為 <strong>Consolas</strong> 或 <strong>微軟正黑體</strong>，<strong>大小 (Size)</strong> 設定為 <strong>12</strong> 或 <strong>14</strong>。</li>
<li>您可以根據個人喜好調整程式碼的顏色配置。</li>
</ol>
<p><img alt="顏色配置" src="/automation/excel-vba%E5%AD%B8%E7%BF%92/image/index/%E9%A1%8F%E8%89%B2%E9%85%8D%E7%BD%AE.png"></p>
<hr>
<h2 id="vba-基礎概念">VBA 基礎概念</h2>
<h3 id="專案與模組">專案與模組</h3>
<ul>
<li><strong>專案 (Project)</strong>：在 VBA 中，一個 Excel 活頁簿（.xlsx, .xlsm）就是一個專案。</li>
<li><strong>模組 (Module)</strong>：是存放 VBA 程式碼的容器。一個專案可以包含多個模組，用來組織不同功能的程式碼。
<ul>
<li><strong>如何新增</strong>：在 <strong>專案總管</strong> 中對您的專案點擊滑鼠右鍵，選擇 <strong>[插入 (Insert)]</strong> &gt; <strong>[模組 (Module)]</strong>。</li>
</ul>
</li>
</ul>
<h3 id="程序-sub--function">程序 (Sub / Function)</h3>
<p><strong>程序</strong> 是 VBA 執行的基本單位，可以想像成一個個獨立的「功能」或「指令集」。</p>
<ul>
<li>
<p><strong>Sub 程序 (Subroutine)</strong>：執行一系列的動作，但不會回傳值。</p>
<pre tabindex="0"><code class="language-vba" data-lang="vba">Sub SayHello()
    MsgBox &#34;Hello, World!&#34;
End Sub
</code></pre><p><img alt="執行程式" src="/automation/excel-vba%E5%AD%B8%E7%BF%92/image/index/%E5%9F%B7%E8%A1%8C%E7%A8%8B%E5%BC%8F.png"></p>
</li>
<li>
<p><strong>Function 程序 (Function)</strong>：執行計算並 <strong>回傳一個值</strong>。</p>
<pre tabindex="0"><code class="language-vba" data-lang="vba">Function AddTwo(num As Integer) As Integer
    AddTwo = num + 2
End Function
</code></pre></li>
<li>
<p><strong>命名規則</strong>：必須以字母開頭，且不能包含空格或特殊符號 (<code>.</code>、<code>!</code>、<code>@</code>、<code>&amp;</code>、<code>$</code>、<code>#</code>)，亦不可使用 VBA 的保留關鍵字。</p>
</li>
</ul>
<h3 id="模組化程式設計-call">模組化程式設計 (Call)</h3>
<p>當程式越來越龐大時，我們會將功能拆分成多個 Sub，並透過 <code>Call</code> 來互相呼叫與傳遞變數。</p>
<ul>
<li>
<p><strong>語法</strong>：<code>Call Sub名稱(參數1, 參數2...)</code></p>
</li>
<li>
<p><strong>範例</strong>：</p>
<pre tabindex="0"><code class="language-vba" data-lang="vba">Sub Main()
    Dim myName As String
    myName = &#34;Tom&#34;
    &#39; 呼叫另一個 Sub，並將變數傳遞過去
    Call GreetUser(myName)
End Sub

Sub GreetUser(name As String)
    MsgBox &#34;Hello, &#34; &amp; name
End Sub
</code></pre><blockquote>
<p><strong>輸出結果</strong>：執行後會跳出視窗顯示 <code>Hello, Tom</code>。</p>
</blockquote>
</li>
</ul>
<h3 id="變數-variables-與資料型別">變數 (Variables) 與資料型別</h3>
<p><strong>變數</strong> 是儲存資料的暫時容器。在 VBA 中，使用 <code>Dim</code> 來宣告變數。</p>
<ul>
<li><strong>語法</strong>：<code>Dim [變數名稱] As [資料型別]</code></li>
<li><strong>常見資料型別</strong>：<code>String</code> (文字)、<code>Integer</code> (整數)、<code>Long</code> (長整數)、<code>Double</code> (浮點數)、<code>Boolean</code> (布林)、<code>Date</code> (日期)、<code>Object</code> (物件)、<code>Variant</code> (萬用)。
<img alt="常用變數類型" src="/automation/excel-vba%E5%AD%B8%E7%BF%92/image/index/%E5%B8%B8%E7%94%A8%E8%AE%8A%E6%95%B8%E9%A1%9E%E5%9E%8B.png"></li>
<li><strong>使用注意事項</strong>：
<ul>
<li><strong>型態不符</strong>：確認賦予的值與宣告的變數類型相符。</li>
<li><strong>溢位</strong>：當數值超出範圍時，需轉換為更大範圍的類型 (如 <code>Integer</code> -&gt; <code>Long</code>)。</li>
<li><strong>物件變數</strong>：指派物件時必須使用 <code>Set</code> 關鍵字 (e.g., <code>Set mySheet = Sheets(1)</code>)。</li>
</ul>
</li>
<li><strong>範例</strong>：
<pre tabindex="0"><code class="language-vba" data-lang="vba">Sub VariableExample()
    Dim name As String
    Dim age As Integer

    name = &#34;Tom&#34;
    age = 30

    MsgBox name &amp; &#34; is &#34; &amp; age &amp; &#34; years old.&#34;
End Sub
</code></pre></li>
</ul>
<h3 id="註解-comments">註解 (Comments)</h3>
<p>註解用來解釋程式碼，以單引號 <code>'</code> 開頭，VBA 會忽略其內容。</p>
<pre tabindex="0"><code class="language-vba" data-lang="vba">&#39; 這是一行註解
MsgBox &#34;這行程式碼會被執行&#34; &#39; 這也是註解
</code></pre><p><img alt="註解" src="/automation/excel-vba%E5%AD%B8%E7%BF%92/image/index/%E8%A8%BB%E8%A7%A3.png"></p>
<hr>
<h2 id="操作-excel-物件與互動">操作 Excel 物件與互動</h2>
<p>VBA 的強大之處在於能直接控制 Excel 的各個物件。</p>
<h3 id="核心物件工作表-worksheet-與儲存格-range--cells">核心物件：工作表 (Worksheet) 與儲存格 (Range / Cells)</h3>
<ul>
<li>
<p><strong>工作表 (Worksheet)</strong></p>
<ul>
<li><strong>依名稱指定</strong>：<code>Sheets(&quot;工作表1&quot;)</code></li>
<li><strong>依順序指定</strong>：<code>Sheets(1)</code> (第一個工作表)</li>
<li><strong>常用操作</strong>：<code>.Name</code> (名稱), <code>.Activate</code> (啟用), <code>.Select</code> (選取)。</li>
</ul>
</li>
<li>
<p><strong>儲存格 (Range / Cells)</strong></p>
<ul>
<li><strong>Range 屬性</strong>：<code>Range(&quot;A1&quot;)</code> 或 <code>Range(&quot;A1:C5&quot;)</code>。</li>
<li><strong>Cells 屬性</strong>：使用列欄索引 <code>Cells(1, 1)</code>，適合在迴圈中使用。</li>
<li><strong>常用操作</strong>：<code>.Value</code> (值), <code>.Formula</code> (公式), <code>.Select</code> (選取), <code>.ClearContents</code> (清除內容)。</li>
</ul>
</li>
<li>
<p><strong>範例</strong>：</p>
<pre tabindex="0"><code class="language-vba" data-lang="vba">Sub CellManipulation()
    &#39; 在 Sheet1 的 A1 儲存格寫入文字
    Sheets(&#34;Sheet1&#34;).Range(&#34;A1&#34;).Value = &#34;這是 A1&#34;

    &#39; 在目前啟用工作表的 B2 儲存格寫入數字
    Cells(2, &#34;B&#34;).Value = 123

    &#39; 讀取 B2 的值並顯示出來
    Dim cellValue As Integer
    cellValue = Cells(2, 2).Value
    MsgBox &#34;B2 的值是: &#34; &amp; cellValue
End Sub
</code></pre></li>
</ul>
<h3 id="互動與除錯及時運算視窗-immediate-window">互動與除錯：及時運算視窗 (Immediate Window)</h3>
<p>這是一個強大的工具 (<code>Ctrl+G</code>)，主要有兩種用途：</p>
<ol>
<li><strong>執行簡短程式</strong>：直接輸入程式碼並按 Enter 即可執行。
<pre tabindex="0"><code>MsgBox &#34;Test&#34;
</code></pre></li>
<li><strong>查詢變數或屬性內容</strong>：在程式中斷或執行時，用 <code>?</code> 開頭來查詢值，或使用 <code>Debug.Print</code> 將訊息輸出至此視窗。
<pre tabindex="0"><code class="language-vba" data-lang="vba">Sub PrintToImmediate()
    Dim myVar As String
    myVar = &#34;Hello from Debug.Print&#34;
    &#39; 將 myVar 的內容輸出到及時運算視窗
    Debug.Print myVar 
End Sub
</code></pre></li>
</ol>
<hr>
<h2 id="條件判斷-conditional-logic">條件判斷 (Conditional Logic)</h2>
<h3 id="if--then--else">If &hellip; Then &hellip; Else</h3>
<p>這是寫程式最基本的邏輯判斷，讓程式能夠根據不同情況執行不同的動作。</p>
<ul>
<li>
<p><strong>語法</strong>：</p>
<pre tabindex="0"><code class="language-vba" data-lang="vba">If 條件 Then
    &#39; 條件成立時執行
ElseIf 其他條件 Then
    &#39; 其他條件成立時執行
Else
    &#39; 以上皆不成立時執行
End If
</code></pre></li>
<li>
<p><strong>範例</strong>：檢查儲存格 A1 的內容是否符合以下條件：</p>
<ol>
<li>必為 4 個字元 (<code>Len</code>)</li>
<li>必為數字 (<code>IsNumeric</code>)</li>
<li>開頭第一個字不可為 0 (<code>Left</code>)</li>
</ol>
<pre tabindex="0"><code class="language-vba" data-lang="vba">Sub CheckInput()
    Dim content As String
    content = Range(&#34;A1&#34;).Value

    &#39; 使用 And 來連接多個條件 (全部都要符合)
    If Len(content) = 4 And IsNumeric(content) And Left(content, 1) &lt;&gt; &#34;0&#34; Then
        MsgBox &#34;格式正確&#34;
    Else
        MsgBox &#34;格式錯誤&#34;
    End If
End Sub
</code></pre><blockquote>
<p><strong>輸出結果</strong>：</p>
<ul>
<li>輸入 <code>1234</code> -&gt; 跳出「格式正確」</li>
<li>輸入 <code>0123</code> -&gt; 跳出「格式錯誤」 (開頭是 0)</li>
<li>輸入 <code>ABCD</code> -&gt; 跳出「格式錯誤」 (非數字)</li>
<li>輸入 <code>123</code> -&gt; 跳出「格式錯誤」 (長度不足)</li>
</ul>
<p><img alt="IF判斷式" src="/automation/excel-vba%E5%AD%B8%E7%BF%92/image/index/IF%E5%88%A4%E6%96%B7%E5%BC%8F.png"></p>
</blockquote>
</li>
</ul>
<hr>
<h2 id="迴圈控制-loops">迴圈控制 (Loops)</h2>
<h3 id="for-each--next-迴圈">For Each &hellip; Next 迴圈</h3>
<p>此迴圈適用於遍歷「集合」或「陣列」中的每一個元素。在 Excel VBA 中，最常用來遍歷 <strong>Range (儲存格範圍)</strong>。</p>
<ul>
<li>
<p><strong>語法</strong>：</p>
<pre tabindex="0"><code class="language-vba" data-lang="vba">For Each 變數名稱 In Cells
    &#39; 對 變數名稱 執行動作
Next [變數名稱]
</code></pre><blockquote>
<p>[!WARNING] <strong>致命陷阱</strong>
雖然語法可以使用 <code>For Each ... In Cells</code>，但 <strong>Cells</strong> 代表整張工作表的所有儲存格 (1,048,576 列 x 16,384 欄)，直接執行會導致 Excel <strong>當機</strong>。
<strong>請務必指定明確的範圍</strong>，例如 <code>Selection</code> (目前選取範圍) 或 <code>Range(&quot;A1:C10&quot;)</code>。</p>
</blockquote>
</li>
<li>
<p><strong>範例</strong>：將選取範圍內數值大於 60 的儲存格標示為紅色字。</p>
<pre tabindex="0"><code class="language-vba" data-lang="vba">Sub HighlightScores()
    Dim cell As Range

    &#39; 建議：明確指定範圍 (例如 Selection 或 Range(&#34;A1:A10&#34;))
    For Each cell In Selection
        If cell.Value &lt; 60 Then
            cell.Font.Color = vbRed &#39; 不及格標紅字
        End If
    Next cell
End Sub
</code></pre><blockquote>
<p><strong>輸出結果</strong>：執行程式後，您選取範圍內數值小於 60 的儲存格，文字顏色將會變成<strong>紅色</strong>。</p>
</blockquote>
<p><img alt="1766820757724" src="/automation/excel-vba%E5%AD%B8%E7%BF%92/image/index/FOR_EACH.png"></p>
</li>
</ul>
<hr>
<h2 id="excel-vba-網路爬蟲">Excel VBA 網路爬蟲</h2>
<p>本章節整理使用 VBA 進行網路資料抓取的概念與實作流程。</p>
<p><img alt="1766832946907" src="/automation/excel-vba%E5%AD%B8%E7%BF%92/image/index/Request.png"></p>
<h3 id="1-網路爬蟲核心概念">1. 網路爬蟲核心概念</h3>
<ul>
<li><strong>網路溝通原理</strong>：網路溝通基於「Request (請求)」與「Response (回應)」。瀏覽器向伺服器發送請求，伺服器回傳資料。</li>
<li><strong>爬蟲定義</strong>：網路爬虫的本質，就是<strong>找出發送哪一個 Request 可以拿到想要的資料</strong>，並用程式模仿這個過程。</li>
</ul>
<h3 id="2-分析網頁資料來源-chrome-開發人員工具">2. 分析網頁資料來源 (Chrome 開發人員工具)</h3>
<p>在 Chrome 中按下 <code>F12</code> 開啟開發人員工具，是分析網頁結構與背景資料請求的利器。</p>
<ul>
<li>
<p><strong>操作步驟</strong>：</p>
<ol>
<li>切換到 <strong>Network</strong> 頁籤。</li>
<li>確認紅燈亮起 (表示正在錄製網路活動)。</li>
<li>在網頁上執行操作 (如點擊、捲動)，並觀察左側出現的請求列表。</li>
</ol>
</li>
<li>
<p><strong>如何尋找資料</strong>：</p>
<ul>
<li><strong>DOC (文件)</strong>：資料直接呈現在網頁的 HTML 內容中，適合抓取靜態表格資料。</li>
<li><strong>XHR (XMLHttpRequest)</strong>：資料是透過背景的 API 請求（非同步）載入的，通常為 JSON 格式，是抓取動態網頁資料的關鍵。</li>
<li><strong>JS (JavaScript)</strong>：資料可能被寫在 JavaScript 程式碼中。</li>
</ul>
<p><img alt="認識Chrome開發人員工具資料藏在哪裡" src="/automation/excel-vba%E5%AD%B8%E7%BF%92/image/index/%E8%AA%8D%E8%AD%98Chrome%E9%96%8B%E7%99%BC%E4%BA%BA%E5%93%A1.png"></p>
</li>
<li>
<p><strong>Request 觀察重點</strong>：找出正確 Request 後，需在右側觀察以下重點以便後續模仿：</p>
<ul>
<li><strong>URL</strong> (網址)</li>
<li><strong>Method</strong> (請求方法)：<code>GET</code> 或 <code>POST</code>。</li>
<li><strong>Header</strong> (標頭資訊)：有時需要模擬 <code>User-agent</code>、<code>Referer</code> 等資訊。</li>
<li><strong>Form Data / Payload</strong>：若為 <code>POST</code> 請求，需觀察其傳遞的參數。</li>
</ul>
</li>
</ul>
<h3 id="3-vba-實作網頁資料抓取">3. VBA 實作網頁資料抓取</h3>
<p>使用 VBA 的 <code>XMLHTTP</code> 或 <code>WinHttp</code> 物件 (&ldquo;小幫手&rdquo;) 來模擬瀏覽器發送 Request。</p>
<ul>
<li>
<p><strong>發送流程</strong>：</p>
<ol>
<li><strong><code>open</code></strong>：設定請求方法 (<code>GET</code>/<code>POST</code>) 與網址 (URL)。</li>
<li><strong><code>setRequestHeader</code></strong>：(非必要) 設定標頭資訊。</li>
<li><strong><code>send</code></strong>：發送請求。若是 <code>POST</code> 方法，需在此步驟傳入參數。</li>
</ol>
</li>
<li>
<p><strong>接收回應</strong>：</p>
<ul>
<li><strong><code>status</code></strong>：檢查 HTTP 狀態碼，<code>200</code> 代表成功。</li>
<li><strong><code>responseText</code></strong>：取得文字形式的回應資料 (如 HTML, JSON)。</li>
<li><strong><code>responseBody</code></strong>：取得原始二進位資料。</li>
</ul>
</li>
<li>
<p><strong>範例：抓取 Yahoo 股市網頁</strong>
以下程式碼示範如何使用 <code>MSXML2.XMLHTTP</code> 物件抓取指定網頁的 HTML 原始碼。</p>
<pre tabindex="0"><code class="language-vba" data-lang="vba">Sub YahooBrokerTrading()
    &#39; 聲明變數
    Dim objHTTP As Object       &#39; 宣告 HTTP 請求物件
    Dim strURL As String        &#39; 儲存目標網址
    Dim strResponse As String   &#39; 儲存伺服器回傳的內容
    Dim lngStatus As Long       &#39; 儲存 HTTP 狀態碼

    &#39; 設定目標網址 (以台積電主力進出表為例)
    strURL = &#34;https://tw.stock.yahoo.com/quote/2330.TW/broker-trading&#34;

    &#39; 1. 建立 HTTP 請求物件
    Set objHTTP = CreateObject(&#34;MSXML2.XMLHTTP&#34;)

    &#39; 2. 設定並發送請求 (使用同步 GET 請求)
    objHTTP.Open &#34;GET&#34;, strURL, False
    objHTTP.send

    &#39; 3. 接收並檢查回應
    lngStatus = objHTTP.Status &#39; 取得回傳的 HTTP 狀態碼

    If lngStatus = 200 Then &#39; 狀態碼 200 表示成功
        strResponse = objHTTP.responseText
        &#39; 此處 strResponse 即為網頁的完整 HTML 內容
        &#39; 可將其寫入儲存格或進行下一步解析
        Debug.Print &#34;成功取得資料，內容長度: &#34; &amp; Len(strResponse)
    Else
        MsgBox &#34;網路請求失敗。HTTP 狀態碼: &#34; &amp; lngStatus, vbCritical
    End If

    &#39; 4. 釋放物件
    Set objHTTP = Nothing
End Sub
</code></pre></li>
</ul>
<h3 id="4-解析不同格式的資料">4. 解析不同格式的資料</h3>
<p>取得回應資料後，需根據其格式進行整理與解析。</p>
<h4 id="a-html-格式">A. HTML 格式</h4>
<ul>
<li><strong>核心物件</strong>：邀請 <code>HTMLFile</code> 小幫手。</li>
<li><strong>操作方式</strong>：將下載的 HTML 文字交給它，再透過 DOM (文件物件模型) 方法取得網頁元素。</li>
<li><strong>取得元素的方法</strong>：
<ul>
<li><code>getElementById(id)</code>: 透過 ID 取得單一元素 (不常用)。</li>
<li><code>getElementsByTagName(tag)</code>: 透過標籤名稱 (如 <code>tr</code>, <code>td</code>, <code>a</code>) 取得元素集合 (常用)。</li>
<li><code>getElementsByClassName(class)</code>: 透過 Class 名稱取得元素集合 (常用)。</li>
</ul>
</li>
<li><strong>印出內容</strong>：使用 <code>.innerText</code> (純文字) 或 <code>.innerHTML</code> (含 HTML 標籤)。</li>
</ul>
<h4 id="b-json-格式">B. JSON 格式</h4>
<ul>
<li><strong>前置作業</strong>：
<ol>
<li>需匯入 <code>JsonConverter.bas</code> 模組。</li>
<li>在 VBA 編輯器中，勾選 <strong>工具 &gt; 設定引用項目 &gt; Microsoft Scripting Runtime</strong>。</li>
</ol>
</li>
<li><strong>解析語法</strong>：使用 <code>JsonConverter.ParseJson(資料)</code> 將 JSON 字串轉換為 VBA 物件 (字典或集合)。</li>
<li><strong>資料存取技巧</strong>：
<ul>
<li><strong>陣列 (<code>[]</code>)</strong>：若資料以 <code>[</code> 開頭，需使用索引值 (如 <code>data(1)</code>) 來存取。</li>
<li><strong>物件 (<code>{}</code>)</strong>：若資料以 <code>{</code> 開頭，需使用 Key 名稱 (如 <code>data(&quot;key&quot;)</code>) 來取值。</li>
</ul>
</li>
</ul>
<h4 id="c-csv-格式逗號分隔值">C. CSV 格式/逗號分隔值</h4>
<p><img alt="1766667758141" src="/automation/excel-vba%E5%AD%B8%E7%BF%92/image/index/csv%E9%87%8D%E8%A6%81%E5%88%87%E5%AD%97.png"></p>
<ul>
<li>可使用 <code>Split</code> 函數搭配換行符號 (<code>vbLf</code> 或 <code>Chr(10)</code>) 將資料切成多列。</li>
<li>再對每一列使用 <code>Split</code> 函數搭配逗號 <code>,</code> 將其切成多個欄位。</li>
</ul>
<h4 id="d-暴力解決法">D. 暴力解決法</h4>
<p>當標準解析方法不適用時，可直接使用 <code>Split</code> 函數，以特定字串為切割點，強行擷取所需資料片段。</p>
<h4 id="e-字串處理split-函數">E. 字串處理：Split 函數</h4>
<p>當資料混在一段長字串中，且有固定的分隔符號（如逗號、空白、斜線）時，<code>Split</code> 是最用的工具。</p>
<p><img alt="Split語法說明" src="/automation/excel-vba%E5%AD%B8%E7%BF%92/image/index/split%E8%AA%9E%E6%B3%95.png"></p>
<ul>
<li>
<p><strong>語法</strong>：<code>Split(原始字串, &quot;分隔符號&quot;)</code> -&gt; 回傳一個陣列</p>
</li>
<li>
<p><strong>範例</strong>：</p>
<pre tabindex="0"><code class="language-vba" data-lang="vba">Sub SplitExample()
    Dim rawText As String
    Dim dataArray() As String

    rawText = &#34;Apple,Banana,Orange&#34;

    &#39; 使用逗號切割字串
    dataArray = Split(rawText, &#34;,&#34;)

    &#39; 取出陣列中的資料 (索引從 0 開始)
    MsgBox &#34;第二個水果是: &#34; &amp; dataArray(1) 
End Sub
</code></pre><blockquote>
<p><strong>輸出結果</strong>：執行後會跳出視窗顯示 <code>第二個水果是: Banana</code>。</p>
</blockquote>
</li>
</ul>
<h4 id="f-字串處理replace-函數">F. 字串處理：Replace 函數</h4>
<p>用來將字串中的某些文字<strong>取代</strong>成新的文字。常用於清理資料（如去除空白、替換符號）。</p>
<ul>
<li>
<p><strong>語法</strong>：<code>Replace(原始字串, &quot;想被換掉的舊字&quot;, &quot;想換成的新字&quot;)</code></p>
</li>
<li>
<p><strong>範例</strong>：</p>
<pre tabindex="0"><code class="language-vba" data-lang="vba">Sub ReplaceExample()
    Dim money As String
    Dim cleanMoney As String

    money = &#34;NT$ 1,200&#34;

    &#39; 1. 去除 &#34;NT$ &#34; (換成空字串)
    cleanMoney = Replace(money, &#34;NT$ &#34;, &#34;&#34;)

    &#39; 2. 去除 &#34;,&#34; (換成空字串)
    cleanMoney = Replace(cleanMoney, &#34;,&#34;, &#34;&#34;)

    MsgBox &#34;清理後的數字: &#34; &amp; cleanMoney
End Sub
</code></pre><blockquote>
<p><strong>輸出結果</strong>：執行後會跳出視窗顯示 <code>清理後的數字: 1200</code>。</p>
</blockquote>
</li>
</ul>
<h4 id="g-進階字串處理chr34-與雙引號的處理">G. 進階字串處理：Chr(34) 與雙引號的處理</h4>
<p>在 VBA (或大多數程式語言) 中，雙引號 <code>&quot;</code> 是用來包住字串的符號。這導致一個常見問題：<strong>如果我的字串內容本身就包含雙引號，該怎麼辦？</strong></p>
<p>例如，我想用程式寫出 HTML：<code>&lt;div class=&quot;box&quot;&gt;</code>。</p>
<ul>
<li>
<p><strong>災難寫法 (Escaping)</strong>：
若直接寫 <code>s = &quot;&lt;div class=&quot;box&quot;&gt;&quot;</code>，程式會報錯，因為它以為 <code>&quot;box&quot;</code> 是程式碼。
VBA 規定：要顯示一個雙引號，必須連續打兩個雙引號 <code>&quot;&quot;</code>。</p>
<pre tabindex="0"><code class="language-vba" data-lang="vba">s = &#34;&lt;div class=&#34;&#34;box&#34;&#34;&gt;&#34; &#39; 超級容易看錯
</code></pre></li>
<li>
<p><strong>救星寫法：Chr(34)</strong>：
<code>Chr(34)</code> 是 ASCII code 中的第 34 號字元，也就是雙引號 <code>&quot;</code>。使用變數連接的方式，程式碼會清晰非常多。</p>
<pre tabindex="0"><code class="language-vba" data-lang="vba">s = &#34;&lt;div class=&#34; &amp; Chr(34) &amp; &#34;box&#34; &amp; Chr(34) &amp; &#34;&gt;&#34;
</code></pre></li>
<li>
<p><strong>與 Replace 搭配使用</strong>：
當我們要清理資料中的雙引號時 (例如 CSV 內容常見 <code>Result=&quot;Pass&quot;</code> 這種格式)，<code>Chr(34)</code> 特別好用。</p>
<pre tabindex="0"><code class="language-vba" data-lang="vba">Sub CleanQuotes()
    Dim rawData As String
    Dim cleanData As String

    rawData = &#34;Name=&#34;&#34;Tom&#34;&#34;&#34; &#39; 模擬資料：Name=&#34;Tom&#34;

    &#39; 方法1：看得眼花撩亂
    cleanData = Replace(rawData, &#34;&#34;&#34;&#34;, &#34;&#34;)

    &#39; 方法2：清楚易讀 (推薦)
    cleanData = Replace(rawData, Chr(34), &#34;&#34;)

    MsgBox cleanData &#39; 輸出: Name=Tom
End Sub
</code></pre></li>
</ul>
<hr>
<h2 id="附錄資源連結">附錄：資源連結</h2>
<ul>
<li><strong>製作流程說明文件</strong>：<a href="https://www.dropbox.com/scl/fi/v7vwjdo7jeekkt1zm865j/_.paper?rlkey=kk8yifxbabsrt8sohdpch49sr&dl=0">Dropbox Paper</a></li>
<li><strong>JSON 簡介</strong>：<a href="https://blog.wu-boy.com/2011/04/%E4%BD%A0%E4%B8%8D%E5%8F%AF%E4%B8%8D%E7%9F%A5%E7%9A%84-json-%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%B4%B9/">不可不知的 JSON 基本介紹</a></li>
<li><strong>財經參考</strong>：<a href="https://www.macromicro.me/spotlights/43/guan-jian-tu-biao-kan-dong-zhang-duan-qi-de-zhai-quan-li-cha-tou-lu-de-xun-xi">看懂長短期的債券利差透露的訊息</a></li>
</ul>
<hr>
<h2 id="範例檔案下載">範例檔案下載</h2>
<p>以下是本筆記中提及的相關 Excel 範例檔案，您可以點擊下載：</p>
<ul>
<li><a href="/automation/excel-vba%E5%AD%B8%E7%BF%92/%E7%88%AC%E8%9F%B2%E7%A8%8B%E5%BC%8F%E7%94%A2%E7%94%9F%E5%99%A8V4.xlsm">爬蟲程式產生器V4.xlsm</a></li>
<li><a href="/automation/excel-vba%E5%AD%B8%E7%BF%92/Yahoo%E4%B8%BB%E5%8A%9B%E9%80%B2%E5%87%BA%E8%A1%A8.xlsm">Yahoo主力進出表.xlsm</a></li>
</ul>
<hr>
<h2 id="常見問題-faq">常見問題 (FAQ)</h2>
<h3 id="q1-字串與變數如何連接">Q1: 字串與變數如何連接？</h3>
<p>VBA 使用 <code>&amp;</code> 符號來連接字串與變數。這在動態組建網址時非常常用。</p>
<pre tabindex="0"><code class="language-vba" data-lang="vba">Dim stock As String
stock = &#34;2330&#34;

&#39; 將變數插入網址字串中
Dim url As String
url = &#34;https://tw.stock.yahoo.com/quote/&#34; &amp; stock &amp; &#34;.TW&#34;
MsgBox url &#39; 輸出: https://tw.stock.yahoo.com/quote/2330.TW
</code></pre><h3 id="q2-爬蟲請求方法-get-與-post-有何差異">Q2: 爬蟲請求方法 GET 與 POST 有何差異？</h3>
<ul>
<li><strong>GET</strong>：
<ul>
<li><strong>特徵</strong>：參數直接附加在網址後面（例如 <code>?id=123</code>），所有人都看得到。</li>
<li><strong>用途</strong>：通常用於<strong>取得</strong>資料（瀏覽網頁、搜尋）。</li>
<li><strong>限制</strong>：網址長度有限制，不適合傳輸大量資料。</li>
</ul>
</li>
<li><strong>POST</strong>：
<ul>
<li><strong>特徵</strong>：參數隱藏在請求主體（Form Data / Payload）中，網址上看不到。</li>
<li><strong>用途</strong>：通常用於<strong>提交</strong>資料（登入帳號、填寫表單、上傳檔案）。</li>
<li><strong>優點</strong>：較適合傳遞敏感或大量資料。</li>
</ul>
</li>
</ul>
<h3 id="5-進階技巧http-headers-設定-request-headers">5. 進階技巧：HTTP Headers 設定 (Request Headers)</h3>
<p>在模仿瀏覽器發送請求時，「標頭 (Headers)」是用來告訴伺服器「我是誰」、「我想要什麼格式的資料」或「我從哪裡來」的重要名片。</p>
<ul>
<li>
<p><strong>設定方法</strong>：
使用 <code>objHTTP.setRequestHeader &quot;Header名稱&quot;, &quot;值&quot;</code> 來設定。
<strong>注意</strong>：<code>setRequestHeader</code> 必須在 <code>Open</code> 之後，<code>Send</code> 之前執行。</p>
</li>
<li>
<p><strong>常見且重要的 Headers</strong>：</p>
<ol>
<li>
<p><strong>Content-Type</strong> (內容類型)：</p>
<ul>
<li><strong>用途</strong>：告訴伺服器我們傳送過去的資料 (Payload) 是什麼格式。</li>
<li><strong>常見值</strong>：
<ul>
<li><code>application/x-www-form-urlencoded</code>：一般的表單提交 (Form Data)。</li>
<li><code>application/json</code>：傳送 JSON 格式資料。</li>
</ul>
</li>
<li><strong>時機</strong>：通常在 <code>POST</code> 請求時必須設定。</li>
</ul>
</li>
<li>
<p><strong>User-Agent</strong> (使用者代理)：</p>
<p><img alt="User-Agent設定說明" src="/automation/excel-vba%E5%AD%B8%E7%BF%92/image/index/user-agent.png"></p>
<ul>
<li><strong>用途</strong>：告訴伺服器我使用的瀏覽器與作業系統資訊。</li>
<li><strong>重要性</strong>：許多網站會封鎖沒有此標頭的請求（視為機器人）。</li>
<li><strong>範例</strong>：<code>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36...</code></li>
</ul>
</li>
<li>
<p><strong>Referer</strong> (來源頁面)：</p>
<ul>
<li>
<p><strong>用途</strong>：告訴伺服器我是從哪個頁面連結過來的。</p>
</li>
<li>
<p><strong>重要性</strong>：有些網站會檢查此標頭以防止盜連。</p>
<p><img alt="1766667355238" src="/automation/excel-vba%E5%AD%B8%E7%BF%92/image/index/referer.png"></p>
</li>
</ul>
</li>
<li>
<p><strong>Cookie</strong>：</p>
<ul>
<li><strong>用途</strong>：包含使用者身分驗證或追蹤資訊。</li>
<li><strong>時機</strong>：抓取需登入的網站時必備。</li>
</ul>
</li>
</ol>
</li>
<li>
<p><strong>程式碼範例</strong>：</p>
<pre tabindex="0"><code class="language-vba" data-lang="vba">Sub SendPostRequestWithHeaders()
    Dim objHTTP As Object
    Dim strURL As String
    Dim strBody As String

    strURL = &#34;https://example.com/api/login&#34;
    strBody = &#34;username=tom&amp;password=123&#34; &#39; 模擬表單資料

    Set objHTTP = CreateObject(&#34;MSXML2.XMLHTTP&#34;)

    objHTTP.Open &#34;POST&#34;, strURL, False

    &#39; --- 設定 Headers (重點) ---
    &#39; 1. 偽裝成 Chrome 瀏覽器
    objHTTP.setRequestHeader &#34;User-Agent&#34;, &#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36&#34;
    &#39; 2. 宣告傳送的資料是表單格式
    objHTTP.setRequestHeader &#34;Content-Type&#34;, &#34;application/x-www-form-urlencoded&#34;
    &#39; 3. 宣告來源 (如果需要)
    objHTTP.setRequestHeader &#34;Referer&#34;, &#34;https://example.com/login&#34;
    &#39; ---------------------------

    objHTTP.send strBody &#39; POST 請求需傳入 Body

    Debug.Print objHTTP.responseText
    Set objHTTP = Nothing
End Sub
</code></pre><blockquote>
<p><strong>輸出結果</strong>：程式執行完畢後，<strong>及時運算視窗</strong> (Immediate Window) 會顯示伺服器回傳的 HTML 或 JSON 內容。</p>
</blockquote>
</li>
</ul>
<hr>
<h2 id="實用工具連結">實用工具連結</h2>
<p>進行網路爬蟲時，常會用到以下工具來處理編碼或偽裝瀏覽器身分：</p>
<ul>
<li>
<p><strong>URL 編碼/解碼工具</strong>：
當網址包含中文字或特殊符號時，伺服器可能無法辨識，需轉換為 URL 編碼（Percent-encoding，如 <code>%E5%8F%B0%E7%81%A3</code>）。</p>
<ul>
<li><a href="https://www.convertstring.com/zh_TW/EncodeDecode/UrlEncode">URL Encode/Decode (ConvertString)</a> - 線上快速轉換工具。</li>
<li><a href="https://blog.gtwang.org/programming/url-percent-encoding-and-decoding-using-java/">URL 編碼原理與實作 (GTWang)</a> - 深入了解編碼原理。</li>
</ul>
</li>
<li>
<p><strong>User Agent 大全</strong>：
有些網站會擋掉沒有 User-Agent 的請求（視為機器人）。我們可以設定 User-Agent Header 來偽裝成 Chrome 或 Edge 瀏覽器。</p>
<ul>
<li><a href="https://tools.jb51.net/table/useragent">常用 User Agent String 列表</a></li>
</ul>
</li>
</ul>
<hr>
<h2 id="結語">結語</h2>
<p>Excel VBA 結合網路爬蟲功能，能將繁瑣的「複製貼上」工作自動化，大幅提升資料收集與整理的效率。</p>
<p><strong>學習建議路徑</strong>：</p>
<ol>
<li><strong>熟悉 VBA 基礎</strong>：變數、迴圈、邏輯判斷。</li>
<li><strong>掌握 HTTP 請求</strong>：了解 GET/POST 與觀察 Network 面板。</li>
<li><strong>練習靜態爬蟲</strong>：從簡單的 HTML 表格抓取開始。</li>
<li><strong>挑戰動態爬蟲</strong>：學習解析 JSON 資料，這是現代網站的主流。</li>
</ol>
<p>希望這份筆記能幫助您在自動化的路上更進一步！</p>

        </div>

        
        <div class="navigation-container">
          
          <div class="post-navigation">
            <div class="row">
              <div class="col-md-6">
                
                <div class="prev-post">
                  <span>上一篇</span>
                  <a href="/automation/office%E5%AD%B8%E7%BF%92/">
                    <h5>OFFICE 學習筆記：Word、PPT、Excel 快速鍵整理</h5>
                  </a>
                </div>
                
              </div>
              <div class="col-md-6 text-right">
                
              </div>
            </div>
          </div>

          
          <div class="navigation-tabs mt-5">
            <ul class="nav nav-tabs" id="navigationTabs" role="tablist">
              <li class="nav-item">
                <a class="nav-link active" id="related-tab" data-toggle="tab" href="#related" role="tab">相關文章</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" id="latest-tab" data-toggle="tab" href="#latest" role="tab">最新文章</a>
              </li>
            </ul>
            <div class="tab-content" id="navigationTabsContent">
              
              <div class="tab-pane fade show active" id="related" role="tabpanel">
                <div class="row mt-4">
                  
                  
                  
                  
                  
                  
                  <div class="col-md-6 mb-3">
                    <div class="post-item">
                      <a href="/automation/office%E5%AD%B8%E7%BF%92/">OFFICE 學習筆記：Word、PPT、Excel 快速鍵整理</a>
                      <small>2025-11-08</small>
                    </div>
                  </div>
                  
                  
                </div>
              </div>

              
              <div class="tab-pane fade" id="latest" role="tabpanel">
                <div class="row mt-4">
                  
                  
                  <div class="col-md-6 mb-3">
                    <div class="post-item">
                      <a href="/lifestyle/%E8%8F%AF%E7%88%BE%E9%81%93%E5%A4%AB%E6%B2%99%E6%8B%89%E5%92%8C%E8%8D%89%E8%8E%93%E8%88%92%E8%8A%99%E8%95%BE%E8%9B%8B%E6%8D%B2/">草莓舒芙蕾蛋捲佐華爾道夫沙拉 (Strawberry Soufflé Omelet &amp; Waldorf Salad)</a>
                      <small>2025-12-20</small>
                    </div>
                  </div>
                  
                  <div class="col-md-6 mb-3">
                    <div class="post-item">
                      <a href="/lifestyle/%E7%BE%A9%E5%BC%8F%E8%BE%A3%E5%91%B3%E7%87%89%E7%85%AE%E7%BE%8A%E8%82%89/">義式辣味燉煮羊肉 (Spicy Basilicata Lamb Stew)</a>
                      <small>2025-12-11</small>
                    </div>
                  </div>
                  
                  <div class="col-md-6 mb-3">
                    <div class="post-item">
                      <a href="/lifestyle/%E5%9F%BA%E8%BC%94%E9%9B%9E%E9%99%84%E7%82%B8%E8%84%86%E8%96%AF%E7%82%92%E7%95%AA%E8%8C%84%E8%88%87%E7%BF%A0%E7%B6%A0%E6%B2%99%E6%8B%89/">基輔雞附炸脆薯炒番茄與翠綠沙拉</a>
                      <small>2025-12-06</small>
                    </div>
                  </div>
                  
                  <div class="col-md-6 mb-3">
                    <div class="post-item">
                      <a href="/lifestyle/%E4%BF%84%E5%BC%8F%E7%87%B4%E7%89%9B%E8%82%89%E9%99%84%E8%94%AC%E8%8F%9C%E9%A3%AF/">俄式燴牛肉附蔬菜飯</a>
                      <small>2025-11-27</small>
                    </div>
                  </div>
                  
                  <div class="col-md-6 mb-3">
                    <div class="post-item">
                      <a href="/lifestyle/%E6%8B%BF%E5%9D%A1%E9%87%8C%E9%82%A3%E4%B8%8D%E5%8B%92%E6%96%AF%E7%82%B8%E6%8A%AB%E8%96%A9/">拿坡里(那不勒斯)炸披薩 Pizza Fritta</a>
                      <small>2025-11-20</small>
                    </div>
                  </div>
                  
                  <div class="col-md-6 mb-3">
                    <div class="post-item">
                      <a href="/lifestyle/%E7%B6%AD%E4%B9%9F%E7%B4%8D%E5%BC%8F%E7%85%8E%E8%B1%AC%E6%8E%92%E9%99%84%E7%95%AA%E8%8C%84%E7%BE%A9%E5%A4%A7%E5%88%A9%E9%BA%B5/">維也納式煎豬排附番茄義大利麵</a>
                      <small>2025-11-15</small>
                    </div>
                  </div>
                  
                </div>
              </div>
            </div>
          </div>
        </div>

        
        <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "tomisagoodguy" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      </div>

      
      
    </div>
  </div>
</section>


<footer class="text-capitalize footer-section">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-12 text-center mb-5">
        <a href="https://tomisagoodguy.github.io/" aria-label="Land-Knowledge">
          <img loading="lazy" src="https://tomisagoodguy.github.io/images/law.png" alt="Land-Knowledge" class="footer-logo">
        </a>
      </div>
      
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">聯絡我們</h6>
        <ul class="list-unstyled contact-list">
          
          <li class="mb-3">
            <a class="text-dark d-flex align-items-center" href="tel:0911445898">
              <i class="ti-mobile text-primary"></i>0911445898
            </a>
          </li>
          
          
          <li class="mb-3 d-flex align-items-center">
            <i class="ti-location-pin text-primary"></i>Taiwan
          </li>
          
          
          <li class="mb-3">
            <a class="text-dark d-flex align-items-center" href="mailto:tom890108159@gmail.com">
              <i class="ti-email text-primary"></i>tom890108159@gmail.com
            </a>
          </li>
          
        </ul>
      </div>
      
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">社群連結</h6>
        <ul class="list-unstyled social-list">
          
          <li class="mb-3">
            <a class="text-dark social-item" href="https://www.facebook.com/profile.php?id=100005583693079" >
              <i class="ti-facebook"></i>facebook
            </a>
          </li>
          
          <li class="mb-3">
            <a class="text-dark social-item" href="https://github.com/tomisagoodguy?tab=repositories" >
              <i class="ti-github"></i>github
            </a>
          </li>
          
        </ul>
      </div>
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">文章分類</h6>
        <ul class="list-unstyled category-list">
          <li class="mb-3">
            <a class="text-dark category-item" href="/categories/">
              查看所有分類
            </a>
          </li>
        </ul>
      </div>
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">快速連結</h6>
        <ul class="list-unstyled quick-links">
          
          <li class="mb-3">
            <a class="text-dark" href="https://tomisagoodguy.github.io/">
              首頁
            </a>
          </li>
          
          <li class="mb-3">
            <a class="text-dark" href="https://tomisagoodguy.github.io/lifestyle/">
              廚藝與生活
            </a>
          </li>
          
          <li class="mb-3">
            <a class="text-dark" href="https://tomisagoodguy.github.io/real-estate/">
              代書修煉
            </a>
          </li>
          
          <li class="mb-3">
            <a class="text-dark" href="https://tomisagoodguy.github.io/automation/">
              自動化實驗室
            </a>
          </li>
          
          <li class="mb-3">
            <a class="text-dark" href="https://tomisagoodguy.github.io/about/">
              關於
            </a>
          </li>
          
          <li class="mb-3">
            <a class="text-dark" href="https://tomisagoodguy.github.io/links/">
              相關連結
            </a>
          </li>
          
        </ul>
      </div>
      <div class="col-12 border-top py-4 text-center footer-copyright">
        | copyright © 2025 定康的學習筆記 All Rights Reserved |
      </div>
    </div>
  </div>
</footer>

<a href="#" id="return-to-top"><i class="fas fa-arrow-up"></i></a>
<a href="#" id="go-to-bottom"><i class="fas fa-arrow-down"></i></a>

<script>
  var indexURL = "https:\/\/tomisagoodguy.github.io\/index.json"
</script>

<!-- JS Plugins -->

<script src="https://tomisagoodguy.github.io/plugins/jQuery/jquery.min.js"  ></script>

<script src="https://tomisagoodguy.github.io/plugins/bootstrap/bootstrap.min.js"  ></script>

<script src="https://tomisagoodguy.github.io/plugins/slick/slick.min.js"  ></script>

<script src="https://tomisagoodguy.github.io/plugins/venobox/venobox.min.js"  ></script>

<script src="https://tomisagoodguy.github.io/plugins/search/fuse.min.js"  ></script>

<script src="https://tomisagoodguy.github.io/plugins/search/mark.js"  ></script>

<script src="https://tomisagoodguy.github.io/plugins/search/search.js"  ></script>

<!-- Main Script -->

<script src="https://tomisagoodguy.github.io/js/script.min.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const themeToggle = document.getElementById('checkbox');
    const body = document.body;
    const themeClass = 'dark-mode';

    function applyTheme(theme) {
      if (theme === 'dark') {
        body.classList.add(themeClass);
        if (themeToggle) themeToggle.checked = true;
        localStorage.setItem('theme', 'dark');
      } else {
        body.classList.remove(themeClass);
        if (themeToggle) themeToggle.checked = false;
        localStorage.setItem('theme', 'light');
      }
    }

    
    const savedTheme = localStorage.getItem('theme');
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

    if (savedTheme === 'dark' || savedTheme === 'dark-mode') {
      applyTheme('dark');
    } else if (!savedTheme && prefersDark) {
      applyTheme('dark');
    } else {
      applyTheme('light');
    }

    
    if (themeToggle) {
      themeToggle.addEventListener('change', function (e) {
        if (e.target.checked) {
          applyTheme('dark');
        } else {
          applyTheme('light');
        }
      });
    }
  });
</script>


<script>
  document.addEventListener('DOMContentLoaded', function () {
    const form = document.getElementById('newsletter-form');
    if (form) {
      form.addEventListener('submit', function (e) {
        e.preventDefault();
        const response = document.getElementById('newsletter-response');
        const email = this.querySelector('input[name="email"]').value;

        
        

        response.innerHTML = '<p class="text-success">感謝您的訂閱！</p>';
        this.reset();
      });
    }
  });
</script>



<script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.2.1/js.cookie.min.js" defer></script>
<div id="js-cookie-box" class="cookie-box cookie-box-hide">
  <div class="container">
    <div class="cookie-content">
      <p>本網站使用Cookie來改善您的瀏覽體驗。繼續使用本網站，即表示您同意我們的Cookie使用政策。</p>
      <div class="cookie-buttons">
        <button id="js-cookie-button" class="btn btn-sm btn-primary">我接受</button>
        <a href="" class="btn btn-sm btn-outline-secondary ml-2">了解更多</a>
      </div>
    </div>
  </div>
</div>
<script>
  (function () {
    const cookieBox = document.getElementById('js-cookie-box');
    const cookieButton = document.getElementById('js-cookie-button');
    if (!Cookies.get('cookie-box')) {
      cookieBox.classList.remove('cookie-box-hide');
      cookieButton.onclick = function () {
        Cookies.set('cookie-box', true, {
          expires:  2 
    });
    cookieBox.classList.add('cookie-box-hide');
  };
		}
	}) ();
</script>

</body>

</html>